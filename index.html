<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Piggy Photos 🐷📸</title>
<style>
  body {
    background: #ffc0cb;
    font-family: 'Comic Sans MS', cursive, sans-serif;
    margin: 0; padding: 0;
    text-align: center;
    overflow-x: hidden;
    user-select: none;
    touch-action: manipulation;
  }
  #canvas {
    border: 4px dashed #cc3366;
    background: white;
    max-width: 95vw;
    touch-action: none; /* ¡Esto evita el scroll al dibujar! */
  }
  button, input, select {
    margin: 5px;
    padding: 10px;
    border-radius: 10px;
    font-size: 1em;
    border: none;
  }
</style>
</head>
<body>

<h1>🐷 Piggy Photos 📸</h1>

<input type="file" id="upload" accept="image/*" />
<input type="color" id="colorPicker" value="#ff0000" />
<button onclick="toggleBrush()">🖌️ Pincel</button>
<button onclick="clearCanvas()">🧹 Limpiar</button>
<button onclick="save()">💾 Guardar</button>
<br />
<canvas id="canvas" width="400" height="400"></canvas>
<br />
<div id="stickers">
  <span draggable="true">🐷</span>
  <span draggable="true">🐽</span>
  <span draggable="true">🐖</span>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const upload = document.getElementById("upload");
const colorPicker = document.getElementById("colorPicker");

let painting = false;
let brushEnabled = true;

canvas.addEventListener("touchstart", e => {
  e.preventDefault(); // ← bloquea scroll en Android
  if (brushEnabled) {
    painting = true;
    drawTouch(e.touches[0]);
  }
}, { passive: false });

canvas.addEventListener("touchmove", e => {
  e.preventDefault(); // ← bloquea scroll en Android
  if (painting && brushEnabled) drawTouch(e.touches[0]);
}, { passive: false });

canvas.addEventListener("touchend", () => painting = false);

canvas.addEventListener("mousedown", () => painting = brushEnabled);
canvas.addEventListener("mouseup", () => painting = false);
canvas.addEventListener("mousemove", e => {
  if (painting && brushEnabled) drawMouse(e);
});

function drawMouse(e) {
  const rect = canvas.getBoundingClientRect();
  ctx.fillStyle = colorPicker.value;
  ctx.beginPath();
  ctx.arc(e.clientX - rect.left, e.clientY - rect.top, 5, 0, Math.PI * 2);
  ctx.fill();
}

function drawTouch(touch) {
  const rect = canvas.getBoundingClientRect();
  ctx.fillStyle = colorPicker.value;
  ctx.beginPath();
  ctx.arc(touch.clientX - rect.left, touch.clientY - rect.top, 5, 0, Math.PI * 2);
  ctx.fill();
}

function toggleBrush() {
  brushEnabled = !brushEnabled;
  alert("Pincel: " + (brushEnabled ? "Activado" : "Desactivado"));
}

function clearCanvas() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
}

function save() {
  const link = document.createElement("a");
  link.download = "piggy-photo.png";
  link.href = canvas.toDataURL();
  link.click();
}

upload.addEventListener("change", e => {
  const file = e.target.files[0];
  const reader = new FileReader();
  reader.onload = evt => {
    const img = new Image();
    img.onload = () => {
      canvas.width = img.width;
      canvas.height = img.height;
      ctx.drawImage(img, 0, 0);
    };
    img.src = evt.target.result;
  };
  reader.readAsDataURL(file);
});

// Drag & Drop stickers
document.querySelectorAll("#stickers span").forEach(sticker => {
  sticker.addEventListener("dragstart", e => {
    e.dataTransfer.setData("text/plain", sticker.textContent);
  });
});

canvas.addEventListener("dragover", e => e.preventDefault());
canvas.addEventListener("drop", e => {
  e.preventDefault();
  const emoji = e.dataTransfer.getData("text/plain");
  const rect = canvas.getBoundingClientRect();
  ctx.font = "40px serif";
  ctx.fillText(emoji, e.clientX - rect.left, e.clientY - rect.top);
});
</script>

<p style="margin: 20px;">Hecho por PiggyStudio121 😺</p>

</body>
</html>
